<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Orders - FreshMart</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

  <nav class="site-nav">
    <div class="nav-container">
      <a href="{{ url_for('home') }}" class="logo">FreshMart</a>

      <div class="nav-right">
        <a href="{{ url_for('home') }}" class="nav-link">Shop</a>
        <a href="{{ url_for('customer_orders') }}" class="nav-link active">Orders</a>
        {% if session.get('role','').lower() in ['employee','admin'] %}
          <a href="{{ url_for('reports') }}" class="nav-link">Reports</a>
        {% endif %}
        <a href="{{ url_for('bag_page') }}" class="bag-link">
          <span>ğŸ›’</span>
          <span>Cart</span>
          <span id="bagCount" class="badge">{{ bag_count }}</span>
        </a>
        <a href="{{ url_for('logout') }}" class="nav-link">Logout</a>
      </div>
    </div>
  </nav>

  <main>
    <div class="account-container">
      <div class="account-header">
        <div>
          <div class="account-title">Your Orders</div>
          <div class="account-subtitle">Track your recent purchases and view details</div>
        </div>
        <div class="loyalty-card">
          <div class="loyalty-title">Member</div>
          <div style="font-size:.85rem;opacity:.9;">Thanks for shopping with FreshMart</div>
        </div>
      </div>
  
      <div class="account-grid">
        <div class="sidebar">
          <a href="{{ url_for('customer_dashboard') }}" class="sidebar-item"><span>ğŸ“Š</span> Dashboard</a>
          <a href="{{ url_for('customer_orders') }}" class="sidebar-item active"><span>ğŸ“¦</span> Orders</a>
          <div class="sidebar-item"><span>ğŸ“</span> Shopping Lists</div>
          <div class="sidebar-item"><span>ğŸ </span> Addresses</div>
          <div class="sidebar-item"><span>ğŸ’³</span> Payment Methods</div>
          <div class="sidebar-item"><span>ğŸ</span> Rewards</div>
          <div class="sidebar-item"><span>âš™ï¸</span> Settings</div>
        </div>
  
        <div class="content-area">
          <h2 style="margin-bottom:1rem;">Order History</h2>
  
          {% if not orders %}
            <div class="card empty-card">
              <div class="empty-emoji">ğŸ§¾</div>
              <p class="empty-text">You haven't placed any orders yet.</p>
              <a class="btn primary" href="{{ url_for('home') }}">Start Shopping</a>
            </div>
          {% else %}
            <div class="orders-list">
              {% for o in orders %}
                <div class="order-card">
                  <div class="order-header">
                    <div>
                      <div class="order-title">Order #{{ o.TransactionID }}</div>
                      <div class="order-subtitle">Placed on {{ o.TransactionDate }}</div>
                    </div>
                    <div class="order-meta">
                      <span class="order-total">${{ '%.2f'|format(o.TotalAmount or 0) }}</span>
                      <span class="status-badge">{{ o.OrderStatus or 'Completed' }}</span>
                    </div>
                  </div>
                  <div class="order-actions">
                    <a class="btn" href="{{ url_for('customer_order_detail', transaction_id=o.TransactionID) }}">View Details</a>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </main>

  <script>
    window.CURRENT_USER = {
      id: {{ session.get('user_id') | tojson }},
      role: {{ session.get('role', '') | tojson }}
    };
  </script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
