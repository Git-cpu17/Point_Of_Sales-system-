<table class="report-table">
  <thead>
    <tr>
      <th><%= typeof dim_label !== 'undefined' ? dim_label : 'Dimension' %></th>
      <th class="num">Units</th>
      <th class="num">Orders</th>
      <th class="num">Avg Unit Price</th>
      <th class="num">Revenue</th>
    </tr>
  </thead>
  <tbody>
    <% if (typeof rows !== 'undefined' && rows && rows.length > 0) { %>
      <% for (let r of rows) { %>
      <tr>
        <td><%= r.DimName %></td>
        <td class="num"><%= r.UnitsSold || 0 %></td>
        <td class="num"><%= r.NumOrders || 0 %></td>
        <td class="num">$<%= (r.AvgUnitPrice || 0).toFixed(2) %></td>
        <td class="num">$<%= (r.GrossRevenue || 0).toFixed(2) %></td>
      </tr>
      <% } %>
    <% } else { %>
      <tr><td colspan="5" class="empty">No data for these filters.</td></tr>
    <% } %>
  </tbody>
  <% if (typeof rows !== 'undefined' && rows && rows.length > 0) { %>
  <tfoot>
    <tr>
      <th>Total</th>
      <th class="num"><%= typeof totals !== 'undefined' ? totals.UnitsSold : 0 %></th>
      <th class="num"><%= typeof totals !== 'undefined' ? totals.NumOrders : 0 %></th>
      <th></th>
      <th class="num">$<%= typeof totals !== 'undefined' ? totals.GrossRevenue.toFixed(2) : '0.00' %></th>
    </tr>
  </tfoot>
  <% } %>
</table>
